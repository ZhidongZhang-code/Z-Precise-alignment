<svg width="800" height="1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Define styles -->
  <defs>
    <style>
      .start-end { fill: #ff9999; stroke: #cc0000; stroke-width: 2; }
      .process { fill: #cce5ff; stroke: #0066cc; stroke-width: 2; }
      .decision { fill: #ffffcc; stroke: #ff9900; stroke-width: 2; }
      .database { fill: #e6f3ff; stroke: #0066cc; stroke-width: 2; }
      .special { fill: #d4f4dd; stroke: #00aa00; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 11px; text-anchor: middle; dominant-baseline: middle; }
      .small-text { font-family: Arial, sans-serif; font-size: 9px; text-anchor: middle; dominant-baseline: middle; }
      .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
      .yes-no { font-family: Arial, sans-serif; font-size: 10px; fill: #666; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="20" class="text" style="font-size: 14px; font-weight: bold;">Computational Pipeline for Protein Sequence Analysis and Functional Domain Prediction</text>

  <!-- Start -->
  <rect x="300" y="40" width="200" height="40" rx="20" class="start-end"/>
  <text x="400" y="60" class="text">Start: Input Protein Sequences</text>

  <!-- Arrow -->
  <line x1="400" y1="80" x2="400" y2="100" class="arrow"/>

  <!-- Read configuration -->
  <rect x="300" y="100" width="200" height="40" rx="5" class="process"/>
  <text x="400" y="120" class="text">Parse Configuration File</text>

  <!-- Arrow -->
  <line x1="400" y1="140" x2="400" y2="160" class="arrow"/>

  <!-- BLAST/DIAMOND comparison -->
  <rect x="280" y="160" width="240" height="40" rx="5" class="process"/>
  <text x="400" y="180" class="text">Perform BLAST/DIAMOND Homology Search</text>

  <!-- Database connection -->
  <ellipse cx="650" cy="180" rx="50" ry="30" class="database"/>
  <text x="650" y="175" class="small-text">Reference</text>
  <text x="650" y="185" class="small-text">Database</text>
  <line x1="520" y1="180" x2="600" y2="180" class="arrow"/>

  <!-- Arrow -->
  <line x1="400" y1="200" x2="400" y2="230" class="arrow"/>

  <!-- Decision: Use HMM -->
  <polygon points="400,230 450,250 400,270 350,250" class="decision"/>
  <text x="400" y="250" class="small-text">Use HMM</text>
  <text x="400" y="260" class="small-text">Search?</text>

  <!-- HMM Search branch (Yes) -->
  <line x1="350" y1="250" x2="200" y2="250" class="arrow"/>
  <text x="275" y="245" class="yes-no">Yes</text>

  <rect x="100" y="280" width="200" height="40" rx="5" class="process"/>
  <text x="200" y="300" class="text">Execute HMMsearch</text>

  <line x1="200" y1="270" x2="200" y2="280" class="arrow"/>
  <line x1="200" y1="320" x2="200" y2="340" class="arrow"/>

  <rect x="100" y="340" width="200" height="40" rx="5" class="process"/>
  <text x="200" y="360" class="text">Extract HMM Profile Matches</text>

  <line x1="200" y1="380" x2="200" y2="400" class="arrow"/>

  <rect x="100" y="400" width="200" height="40" rx="5" class="process"/>
  <text x="200" y="420" class="text">Integrate BLAST Results</text>

  <line x1="200" y1="440" x2="200" y2="480" class="arrow"/>
  <line x1="200" y1="480" x2="400" y2="480" class="arrow"/>

  <!-- Skip HMM branch (No) -->
  <line x1="450" y1="250" x2="580" y2="250" class="arrow"/>
  <text x="515" y="245" class="yes-no">No</text>

  <rect x="500" y="280" width="160" height="60" rx="5" class="special"/>
  <text x="580" y="300" class="small-text">Skip HMMsearch,</text>
  <text x="580" y="315" class="small-text">Use BLAST Results</text>
  <text x="580" y="330" class="small-text">Directly</text>

  <line x1="580" y1="270" x2="580" y2="280" class="arrow"/>
  <line x1="580" y1="340" x2="580" y2="480" class="arrow"/>
  <line x1="580" y1="480" x2="400" y2="480" class="arrow"/>

  <!-- Result filtering -->
  <rect x="300" y="500" width="200" height="40" rx="5" class="process"/>
  <text x="400" y="520" class="text">Apply Quality Filters</text>

  <line x1="400" y1="480" x2="400" y2="500" class="arrow"/>
  <line x1="400" y1="540" x2="400" y2="570" class="arrow"/>

  <!-- Decision: Use Pfam -->
  <polygon points="400,570 450,590 400,610 350,590" class="decision"/>
  <text x="400" y="590" class="small-text">Pfam Domain</text>
  <text x="400" y="600" class="small-text">Prediction?</text>

  <!-- Pfam branch (Yes) -->
  <line x1="350" y1="590" x2="150" y2="590" class="arrow"/>
  <text x="250" y="585" class="yes-no">Yes</text>

  <rect x="50" y="620" width="200" height="40" rx="5" class="special"/>
  <text x="150" y="640" class="text">Pfam Domain Annotation</text>

  <line x1="150" y1="610" x2="150" y2="620" class="arrow"/>
  <line x1="150" y1="660" x2="150" y2="720" class="arrow"/>
  <line x1="150" y1="720" x2="400" y2="720" class="arrow"/>

  <!-- No Pfam branch -->
  <line x1="450" y1="590" x2="550" y2="590" class="arrow"/>
  <text x="500" y="585" class="yes-no">No</text>

  <rect x="500" y="620" width="160" height="40" rx="5" class="special"/>
  <text x="580" y="640" class="text">Use Previous Results</text>

  <line x1="580" y1="610" x2="580" y2="620" class="arrow"/>
  <line x1="580" y1="660" x2="580" y2="720" class="arrow"/>
  <line x1="580" y1="720" x2="400" y2="720" class="arrow"/>

  <!-- Return comparison results -->
  <rect x="250" y="740" width="300" height="40" rx="5" class="process"/>
  <text x="400" y="760" class="text">Generate Comparative Analysis Report</text>

  <line x1="400" y1="720" x2="400" y2="740" class="arrow"/>
  <line x1="400" y1="780" x2="400" y2="810" class="arrow"/>

  <!-- Decision: Clustering -->
  <polygon points="400,810 450,830 400,850 350,830" class="decision"/>
  <text x="400" y="830" class="small-text">Perform</text>
  <text x="400" y="840" class="small-text">Clustering?</text>

  <!-- No clustering -->
  <line x1="350" y1="830" x2="150" y2="830" class="arrow"/>
  <text x="250" y="825" class="yes-no">No</text>

  <rect x="50" y="860" width="200" height="40" rx="5" class="process"/>
  <text x="150" y="880" class="text">Output Final Results</text>

  <line x1="150" y1="850" x2="150" y2="860" class="arrow"/>
  <line x1="150" y1="900" x2="150" y2="940" class="arrow"/>
  <line x1="150" y1="940" x2="400" y2="940" class="arrow"/>

  <!-- Clustering branch -->
  <line x1="450" y1="830" x2="680" y2="830" class="arrow"/>
  <text x="565" y="825" class="yes-no">Yes</text>

  <!-- Activity point detection -->
  <rect x="620" y="800" width="120" height="30" rx="5" class="special"/>
  <text x="680" y="815" class="small-text">Detect Active Sites</text>

  <line x1="680" y1="830" x2="680" y2="840" class="arrow"/>

  <!-- Protein extraction -->
  <rect x="580" y="840" width="200" height="40" rx="5" class="process"/>
  <text x="680" y="860" class="text">Extract Protein Sequences</text>

  <line x1="680" y1="880" x2="680" y2="900" class="arrow"/>

  <!-- ClustalO alignment -->
  <rect x="580" y="900" width="200" height="40" rx="5" class="process"/>
  <text x="680" y="920" class="text">Perform ClustalÎ© Alignment</text>

  <line x1="680" y1="940" x2="680" y2="960" class="arrow"/>

  <!-- Define target regions -->
  <rect x="580" y="960" width="200" height="40" rx="5" class="process"/>
  <text x="680" y="980" class="text">Define Conserved Regions</text>

  <line x1="680" y1="1000" x2="680" y2="1020" class="arrow"/>
  <line x1="680" y1="1020" x2="400" y2="1020" class="arrow"/>
  <line x1="400" y1="1020" x2="400" y2="940" class="arrow"/>

  <!-- End -->
  <rect x="300" y="940" width="200" height="40" rx="20" class="start-end"/>
  <text x="400" y="960" class="text">End: Generate Final Report</text>

</svg>